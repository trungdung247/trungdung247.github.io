"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[116],{60116:function(e,n,t){t.r(n),t.d(n,{RequestAccessCollaboration:function(){return b},default:function(){return g}});var r=t(11010),o=t(91309),i=t(97582),a=t(85893),c=t(67294),s=t(43376),l=t(65400),u=t.n(l),d=t(83403),m=t(58673),p=t(82729),f=t(94589),h=t(72071);function _templateObject(){var e=(0,p._)(["\n  color: #fff;\n  width: 100vw;\n  height: 100vh;\n  .overlay {\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    ",";\n    position: absolute;\n    // backdrop-filter: blur(4px);\n    background: rgba(0, 0, 0, 0.25);\n    .form {\n      width: 440px;\n      padding: 48px 24px 24px;\n      max-width: 90%;\n      position: relative;\n      background: rgba(0, 0, 0, 0.2);\n      background-image: linear-gradient(\n        114deg,\n        rgb(255 255 255 / 1%),\n        rgb(255 255 255 / 12%) 43%,\n        transparent 43.1%,\n        transparent\n      );\n      border-radius: 16px;\n      box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);\n      backdrop-filter: blur(10px);\n      border: 1px solid rgba(255, 255, 255, 0.46);\n    }\n    .icon {\n      position: absolute;\n      width: 56px;\n      height: 56px;\n      top: -28px;\n      left: 50%;\n      transform: translateX(-50%);\n      ",";\n      color: #fff;\n      background: var(--color-theme);\n      border-radius: 50%;\n      font-size: 1.5rem;\n      z-index: 2;\n    }\n    .content {\n      width: 100%;\n      z-index: 2;\n      ",";\n      line-height: 180%;\n      text-align: center;\n      h2 {\n        color: #fff;\n      }\n      .title {\n        margin: 32px 0 12px;\n        font-weight: 500;\n        font-size: var(--fontSize-h5);\n      }\n      .action {\n        .ant-btn {\n          background: var(--color-theme);\n          color: #fff;\n          box-shadow: 0px 4px 12px rgb(0 0 0 / 0.2);\n          border-radius: 6px;\n          border: none;\n          padding: 8px 36px;\n          height: auto;\n        }\n      }\n    }\n  }\n"]);return _templateObject=function(){return e},e}var v=f.ZP.div.withConfig({displayName:"styled__RequestAccessCollaborationWrapper",componentId:"Panoee__sc-c50e8bf8-0"})(_templateObject(),h.b0,h.b0,h.S8),b=(0,c.memo)(function(e){var n=e.scene,t=e.project_id,l=(0,o._)((0,c.useState)(!1),2),p=l[0],f=l[1],h=(0,o._)((0,m.yG)("loading"),1)[0],b=(0,d.d)().onRequestAccessCollaboration,g=(0,c.useMemo)(function(){var e,t,r;return(null==n?void 0:null===(e=n.media)||void 0===e?void 0:e.src_preview)||(null==n?void 0:null===(t=n.media)||void 0===t?void 0:t.src_thumb)||(null==n?void 0:null===(r=n.media)||void 0===r?void 0:r.src)},[n]),C=(0,c.useCallback)((0,r._)(function(){return(0,i.Jh)(this,function(e){switch(e.label){case 0:return[4,b(t)];case 1:return e.sent().msg&&f(!0),[2]}})}),[b,t]);return(0,a.jsxs)(v,{children:[(0,a.jsx)(s.default,{urlTour:g||"",scene:n||void 0,krpanoId:"previewViewer",divId:"previewContainer",styleContainer:{height:"100%",position:"absolute",width:"100%",top:0,left:0}}),(0,a.jsx)("div",{className:"overlay",children:(0,a.jsxs)("div",{className:"form",children:[(0,a.jsx)("div",{className:"bg"}),(0,a.jsx)("div",{className:"icon",children:(0,a.jsx)("i",{"aria-hidden":!0,className:"fas fa-lock"})}),(0,a.jsxs)("div",{className:"content",children:[!p&&(0,a.jsx)("h2",{children:"You do not have sufficient permission to access this page"}),(0,a.jsx)("div",{className:"title",children:p?"Send request access successfully!":"Please contact this Virtual Tour's owner to ensure that collaboration is enabled\n                or you have been granted access!"}),!p&&(0,a.jsx)("div",{className:"action",children:(0,a.jsx)(u(),{loading:h,disabled:h,type:"primary",onClick:C,children:"Request Sharing"})})]})]})})]})}),g=b},58673:function(e,n,t){t.d(n,{EB:function(){return i},FN:function(){return a},Oj:function(){return o},gU:function(){return l},tf:function(){return s},yG:function(){return c}});var r=t(39755),o=(0,r.r)({vlookat:void 0}).useGlobalState,i=(0,r.r)({hlookat:void 0}).useGlobalState,a=(0,r.r)({zoom:void 0}).useGlobalState,c=(0,r.r)({loading:!1,krpanoRef:null,commentSceneSelected:null,isShowDialogCreateCommentScene:!1,commentSceneTemporary:null}).useGlobalState,s=(0,r.r)({stats:{isShowControlbar:!0,btnDirectionActive:"",isGyroscopeAvailable:!1}}).useGlobalState,l=(0,r.r)({state:{isLoaded:!1,idPostProjectSelected:"",visibleDialogPostProject:!1,idPostSceneSelected:"",visibleDialogPostScene:!1,isSoundOnScene:!1,isVisibleMap:!0,isVisibleFloorplan:!0,isVisibleDollhouse:!1,isVisiblePopupIntro:void 0,isActiveModeMultipleStaging:!1,descriptionHotspotSelected:void 0}}).useGlobalState},83403:function(e,n,t){t.d(n,{d:function(){return useCommentScene}});var r=t(11010),o=t(72253),i=t(14932),a=t(91309),c=t(4586),s=t(97582),l=t(62633),u=t(67294),d=t(25617),m=t(58673),p=t(61935),f=t(1214),useCommentScene=function(){var e,n,t,h,v=(0,d.I0)(),b=(0,d.v9)(p.rK),g=(0,d.v9)(p.bn),C=(0,d.v9)(p.eu),_=(0,d.v9)(p.ej),S=(0,d.v9)(p.Iy),w=(0,u.useRef)([]),x=(0,a._)((0,m.yG)("krpanoRef"),1)[0],y=(0,a._)((0,m.yG)("commentSceneSelected"),2)[1],k=(0,a._)((0,m.yG)("isShowDialogCreateCommentScene"),2)[1],j=(0,a._)((0,m.yG)("loading"),2)[1],O=(0,u.useMemo)(function(){var e,n,t;return(null==g?void 0:null===(t=g.filter(function(e){return!e.parent}))||void 0===t?void 0:null===(n=t.slice())||void 0===n?void 0:null===(e=n.sort(function(e,n){return e.created_at.localeCompare(n.created_at)}))||void 0===e?void 0:e.map(function(e,n){var t,r,a,c;return(0,i._)((0,o._)({},e),{index:n+1,isOwnerTour:_,isOwnerComment:(null===(t=e.user)||void 0===t?void 0:t.id)===(null==C?void 0:C.id),children:(null==g?void 0:null===(c=g.filter(function(n){return n.parent===e.id}))||void 0===c?void 0:null===(a=c.map(function(e){var n;return(0,i._)((0,o._)({},e),{isOwnerTour:_,isOwnerComment:(null===(n=e.user)||void 0===n?void 0:n.id)===(null==C?void 0:C.id)})}))||void 0===a?void 0:null===(r=a.slice())||void 0===r?void 0:r.sort(function(e,n){return n.created_at.localeCompare(e.created_at)}))||[]})}))||[]},[null==C?void 0:C.id,_,g]),R=(0,u.useMemo)(function(){return O.filter(function(e){return!!e.isResolved})},[O]),G=(0,u.useMemo)(function(){return O.filter(function(e){return!e.isResolved})},[O]);(0,u.useEffect)(function(){w.current=O},[O]);var A=(0,u.useCallback)((e=(0,r._)(function(e){return(0,s.Jh)(this,function(n){switch(n.label){case 0:j(!0),n.label=1;case 1:return n.trys.push([1,,3,4]),[4,l.R.$post("/comment-scene/send-request-access-collab",{project_id:e},{headers:{Authorization:"Bearer ".concat(b)}})];case 2:return[2,n.sent().data];case 3:return j(!1),[7];case 4:return[2]}})}),function(n){return e.apply(this,arguments)}),[b,j]),N=(0,u.useCallback)((n=(0,r._)(function(e){var n,t,r,a,u=arguments;return(0,s.Jh)(this,function(s){switch(s.label){case 0:n=u.length>1&&void 0!==u[1]?u[1]:x,j(!0),s.label=1;case 1:return s.trys.push([1,,3,4]),[4,l.R.$post("/comment-scene/create",e,{headers:{Authorization:"Bearer ".concat(b)}})];case 2:return t=s.sent().data,v(f.Nw.createCommentScene(t.data)),t.data.parent?(a=w.current.filter(function(e){return e.id===t.data.parent})[0],r=(0,i._)((0,o._)({},a),{children:[(0,i._)((0,o._)({},t.data),{isOwnerTour:_,isOwnerComment:!0})].concat((0,c._)(a.children||[]))}),n&&n.onReplaceCommentScene(r)):((r=(0,i._)((0,o._)({},t.data),{isOwnerTour:_,isOwnerComment:!0,index:w.current.length+1})).children=[],n&&n.onAddCommentScene(r)),k(!1),[3,4];case 3:return j(!1),[7];case 4:return[2]}})}),function(e){return n.apply(this,arguments)}),[b,v,j,_,x,k]),P=(0,u.useCallback)((t=(0,r._)(function(e){var n,t,r,a,c=arguments;return(0,s.Jh)(this,function(s){switch(s.label){case 0:n=c.length>1&&void 0!==c[1]?c[1]:x,j(!0),s.label=1;case 1:return s.trys.push([1,,3,4]),[4,l.R.$put("/comment-scene/update",e,{headers:{Authorization:"Bearer ".concat(b)}})];case 2:return t=s.sent().data,v(f.Nw.updateCommentScene(t.data)),t.data.parent?(r=w.current.filter(function(e){return e.id===t.data.parent})[0]).children=r.children.map(function(e){return e.id===t.data.id?(0,i._)((0,o._)({},t.data),{children:[],isOwnerTour:_,isOwnerComment:!0}):e}):(a=w.current.filter(function(e){return e.id===t.data.id})[0],r=(0,i._)((0,o._)({},a,t.data),{isOwnerTour:_,isOwnerComment:!0})),n&&n.onReplaceCommentScene(r),[3,4];case 3:return j(!1),[7];case 4:return[2]}})}),function(e){return t.apply(this,arguments)}),[x,j,b,v,_]),T=(0,u.useCallback)((h=(0,r._)(function(e){var n,t,r,o=arguments;return(0,s.Jh)(this,function(i){switch(i.label){case 0:n=o.length>1&&void 0!==o[1]?o[1]:x,t=o.length>2&&void 0!==o[2]&&o[2],j(!0),i.label=1;case 1:return i.trys.push([1,,3,4]),[4,l.R.$delete("/comment-scene/delete",{id:e.id},{headers:{Authorization:"Bearer ".concat(b)}})];case 2:return i.sent(),v(f.Nw.deleteCommentScene(e)),e.parent?((r=w.current.filter(function(n){return n.id===e.parent})[0]).children=r.children.filter(function(n){return n.id!==e.id}),n&&n.onReplaceCommentScene(r)):n&&n.onRemoveCommentScene(e.id),t&&y(null),[3,4];case 3:return j(!1),[7];case 4:return[2]}})}),function(e){return h.apply(this,arguments)}),[b,v,j,x,y]);return(0,u.useMemo)(function(){return{isOwnerTour:_,onCreateCommentScene:N,onUpdateCommentScene:P,onDeleteCommentScene:T,listCommentSceneGroupByParent:O,onRequestAccessCollaboration:A,isAllowToAccessOnCollaborationMode:S,listCommentSceneGroupByParentActive:G,listCommentSceneGroupByParentResolved:R}},[_,N,P,T,A,O,S,G,R])}}}]);
//# sourceMappingURL=116.2bd0225b183b4377.js.map